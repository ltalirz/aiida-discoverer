---
- name: install apt dependencies
  become: true
  apt:
      name: 
        - nodejs
        - zip

- name: Get jmol
  get_url:
    url: "https://sourceforge.net/projects/jmol/files/Jmol/Version%2014.29/Jmol%2014.29.22/Jmol-14.29.22-binary.zip/download"
    dest: "{{ ansible_env.HOME }}/jmol.zip"
  register: jmol_download

- name: Extract jmol source
  unarchive:
    src: "{{ ansible_env.HOME }}/jmol.zip"
    dest: "{{ ansible_env.HOME }}/"
    remote_src: True
  when: jmol_download.changed

- name: Extract jsmol source
  unarchive:
    src: "{{ ansible_env.HOME }}/jmol-14.29.22/jsmol.zip"
    dest: "{{ ansible_env.HOME }}/jmol-14.29.22"
    remote_src: True
  when: jmol_download.changed

## Copy bokeh app
#WORKDIR /project/discover-cofs
#COPY figure ./figure
#COPY detail ./detail
#COPY select-figure ./select-figure
#RUN ln -s /project/jmol-14.29.22/jsmol ./detail/static/jsmol
#COPY setup.py import_db.py ./
#RUN pip install -e .
#COPY serve-app.sh /opt/
#
## start bokeh server
#EXPOSE 5006
#CMD ["/opt/serve-app.sh"]
